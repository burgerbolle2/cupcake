<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment â€“ Olsker Cupcakes</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}" />
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const balance = parseFloat(document.getElementById("balance").textContent);
            const totalPrice = parseFloat(document.getElementById("totalPrice").textContent);
            const payButton = document.getElementById("payButton");

            if (balance < totalPrice) {
                payButton.disabled = true;
            }
        });
    </script>
</head>
<body class="login-page">

<header class="login-header">
    <div class="user-info">
        Logged in as: <span th:text="${session.email}"></span>
    </div>
    <img src="/images/cupcakelogo.png" alt="Cupcake banner" class="header-cupcake-img" />
    <img src="/images/logo.png" alt="Olsker Cupcakes Logo" class="logo" />
</header>

<main class="login-container">
    <h1>Checkout</h1>

    <p>Your current balance: <span id="balance" th:text="${balance}"></span> USD</p>
    <p>Total price of order: <span id="totalPrice" th:text="${total_price}"></span> USD</p>

    <form action="/complete-order" method="post">
        <input type="hidden" name="orders_id" th:value="${orders_id}">
        <button type="submit" id="payButton" th:disabled="${balance < total_price}">Complete Payment</button>
    </form>

    <p id="errorMessage" th:if="${message}" class="error-message" th:text="${message}"></p>

    <a class="login-link" href="/shop">Back to Shop</a>

</main>

</body>
</html>

